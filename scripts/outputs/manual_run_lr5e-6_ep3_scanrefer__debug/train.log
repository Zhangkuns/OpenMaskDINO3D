2025-01-30T08:18:37 | INFO | vindlu : Logging to: outputs/manual_run_lr5e-6_ep3_scanrefer__debug/train.log
2025-01-30T08:18:37 | INFO | utils.config_utils : config: {
  anno_root: annotations
  pc_encoder: 
  segmentor: 
  version: 
  gt_feat_file: annotations/scannet_gt_uni3d_feats.pt
  seg_feat_file: annotations/scannet_mask3d_uni3d_feats.pt
  seg_all_feat_file: annotations/scannet_mask3d_uni3d_feats_all.pt
  gt_img_feat_file: annotations/scannet_gt_videofeats.pt
  seg_img_feat_file: annotations/scannet_mask3d_videofeats.pt
  seg_all_img_feat_file: annotations/scannet_mask3d_videofeats_all.pt
  gt_train_attr_file: annotations/scannet_train_attributes.pt
  gt_val_attr_file: annotations/scannet_val_attributes.pt
  seg_train_attr_file: annotations/scannet_mask3d_train_attributes.pt
  seg_val_attr_file: annotations/scannet_mask3d_val_attributes.pt
  seg_all_attr_file: annotations/scannet_mask3d_all_attributes.pt
  train_tag: scanrefer
  val_tag: scanqa#scan2cap#sqa3d#multi3dref
  train_file_dict: {
      scanrefer: ['annotations/scannet_mask3d_uni3d_feats.pt', 'annotations/scannet_mask3d_videofeats.pt', 'annotations/scannet_mask3d_train_attributes.pt', 'annotations/scanrefer_mask3d_train.json']
      scanrefer_location: ['annotations/scannet_mask3d_uni3d_feats.pt', 'annotations/scannet_mask3d_videofeats.pt', 'annotations/scannet_mask3d_train_attributes.pt', 'annotations/scanrefer_mask3d_train_location.json']
      nr3d_seg: ['annotations/scannet_mask3d_uni3d_feats.pt', 'annotations/scannet_mask3d_videofeats.pt', 'annotations/scannet_mask3d_train_attributes.pt', 'annotations/nr3d_mask3d_train.json']
      sr3d_seg: ['annotations/scannet_mask3d_uni3d_feats.pt', 'annotations/scannet_mask3d_videofeats.pt', 'annotations/scannet_mask3d_train_attributes.pt', 'annotations/sr3d_mask3d_train.json']
      nr3d: ['annotations/scannet_gt_uni3d_feats.pt', 'annotations/scannet_gt_videofeats.pt', 'annotations/scannet_train_attributes.pt', 'annotations/nr3d_train.json']
      sr3d: ['annotations/scannet_gt_uni3d_feats.pt', 'annotations/scannet_gt_videofeats.pt', 'annotations/scannet_train_attributes.pt', 'annotations/sr3d_train.json']
      scan2cap: ['annotations/scannet_mask3d_uni3d_feats.pt', 'annotations/scannet_mask3d_videofeats.pt', 'annotations/scannet_mask3d_train_attributes.pt', 'annotations/scan2cap_mask3d_train.json']
      scan2cap_location: ['annotations/scannet_mask3d_uni3d_feats.pt', 'annotations/scannet_mask3d_videofeats.pt', 'annotations/scannet_mask3d_train_attributes.pt', 'annotations/scan2cap_mask3d_train_location.json']
      nr3d_caption: ['annotations/scannet_mask3d_uni3d_feats.pt', 'annotations/scannet_mask3d_videofeats.pt', 'annotations/scannet_mask3d_train_attributes.pt', 'annotations/nr3d_caption_mask3d_train.json']
      obj_align: ['annotations/scannet_mask3d_uni3d_feats.pt', 'annotations/scannet_mask3d_videofeats.pt', 'annotations/scannet_mask3d_train_attributes.pt', 'annotations/obj_align_mask3d_train.json']
      scanqa: ['annotations/scannet_mask3d_uni3d_feats.pt', 'annotations/scannet_mask3d_videofeats.pt', 'annotations/scannet_mask3d_train_attributes.pt', 'annotations/scanqa_train.json']
      sqa3d: ['annotations/scannet_mask3d_uni3d_feats.pt', 'annotations/scannet_mask3d_videofeats.pt', 'annotations/scannet_mask3d_train_attributes.pt', 'annotations/sqa3d_train.json']
      multi3dref: ['annotations/scannet_mask3d_uni3d_feats.pt', 'annotations/scannet_mask3d_videofeats.pt', 'annotations/scannet_mask3d_train_attributes.pt', 'annotations/multi3dref_mask3d_train.json']
      multi3dref_location: ['annotations/scannet_mask3d_uni3d_feats.pt', 'annotations/scannet_mask3d_videofeats.pt', 'annotations/scannet_mask3d_train_attributes.pt', 'annotations/multi3dref_mask3d_train_location.json']
      scannet_caption: ['annotations/scannet_mask3d_uni3d_feats.pt', 'annotations/scannet_mask3d_videofeats.pt', 'annotations/scannet_mask3d_train_attributes.pt', 'annotations/scannet_caption_mask3d_train.json']
      scannet_region_caption: ['annotations/scannet_mask3d_uni3d_feats.pt', 'annotations/scannet_mask3d_videofeats.pt', 'annotations/scannet_mask3d_train_attributes.pt', 'annotations/scannet_region_caption_mask3d_train.json'] }
  val_file_dict: {
      scanqa: ['annotations/scannet_mask3d_uni3d_feats.pt', 'annotations/scannet_mask3d_videofeats.pt', 'annotations/scannet_mask3d_val_attributes.pt', 'annotations/scanqa_val.json']
      scanqa_test: ['annotations/scannet_mask3d_uni3d_feats_all.pt', 'annotations/scannet_mask3d_videofeats_all.pt', 'annotations/scannet_mask3d_all_attributes.pt', 'annotations/scanqa_test.json']
      scanrefer: ['annotations/scannet_mask3d_uni3d_feats.pt', 'annotations/scannet_mask3d_videofeats.pt', 'annotations/scannet_mask3d_val_attributes.pt', 'annotations/scanrefer_mask3d_val.json']
      scanrefer_test: ['annotations/scannet_mask3d_uni3d_feats_all.pt', 'annotations/scannet_mask3d_videofeats_all.pt', 'annotations/scannet_mask3d_all_attributes.pt', 'annotations/scanrefer_mask3d_test.json']
      scanrefer_location: ['annotations/scannet_mask3d_uni3d_feats.pt', 'annotations/scannet_mask3d_videofeats.pt', 'annotations/scannet_mask3d_val_attributes.pt', 'annotations/scanrefer_mask3d_val_location.json']
      nr3d: ['annotations/scannet_gt_uni3d_feats.pt', 'annotations/scannet_gt_videofeats.pt', 'annotations/scannet_val_attributes.pt', 'annotations/nr3d_val.json']
      nr3d_seg: ['annotations/scannet_mask3d_uni3d_feats.pt', 'annotations/scannet_mask3d_videofeats.pt', 'annotations/scannet_mask3d_val_attributes.pt', 'annotations/nr3d_mask3d_val.json']
      sr3d: ['annotations/scannet_gt_uni3d_feats.pt', 'annotations/scannet_gt_videofeats.pt', 'annotations/scannet_val_attributes.pt', 'annotations/sr3d_val.json']
      sr3d_seg: ['annotations/scannet_mask3d_uni3d_feats.pt', 'annotations/scannet_mask3d_videofeats.pt', 'annotations/scannet_mask3d_val_attributes.pt', 'annotations/sr3d_mask3d_val.json']
      scan2cap: ['annotations/scannet_mask3d_uni3d_feats.pt', 'annotations/scannet_mask3d_videofeats.pt', 'annotations/scannet_mask3d_val_attributes.pt', 'annotations/scan2cap_mask3d_val.json']
      scan2cap_test: ['annotations/scannet_mask3d_uni3d_feats_all.pt', 'annotations/scannet_mask3d_videofeats_all.pt', 'annotations/scannet_mask3d_all_attributes.pt', 'annotations/scan2cap_mask3d_test.json']
      scan2cap_location: ['annotations/scannet_mask3d_uni3d_feats.pt', 'annotations/scannet_mask3d_videofeats.pt', 'annotations/scannet_mask3d_val_attributes.pt', 'annotations/scan2cap_mask3d_val_location.json']
      sqa3d: ['annotations/scannet_mask3d_uni3d_feats.pt', 'annotations/scannet_mask3d_videofeats.pt', 'annotations/scannet_mask3d_val_attributes.pt', 'annotations/sqa3d_val.json']
      sqa3d_test: ['annotations/scannet_mask3d_uni3d_feats_all.pt', 'annotations/scannet_mask3d_videofeats_all.pt', 'annotations/scannet_mask3d_all_attributes.pt', 'annotations/sqa3d_test.json']
      multi3dref: ['annotations/scannet_mask3d_uni3d_feats.pt', 'annotations/scannet_mask3d_videofeats.pt', 'annotations/scannet_mask3d_val_attributes.pt', 'annotations/multi3dref_mask3d_val.json']
      multi3dref_location: ['annotations/scannet_mask3d_uni3d_feats.pt', 'annotations/scannet_mask3d_videofeats.pt', 'annotations/scannet_mask3d_val_attributes.pt', 'annotations/multi3dref_mask3d_val_location.json'] }
  num_workers: 32
  batch_size: 2
  model: {
      llama_model_path: llm/vicuna-7b-v1.5
      input_dim: 1024
      img_input_dim: 1024
      attr_dim: 512
      scene_dim: 256
      pos_dim: 128
      encoder_num_layers: 3
      low_resource: True
      system_path: prompts/system.txt
      instruction_path: prompts/instruction.txt
      max_txt_len: 64
      end_sym: </s>
      role: ['USER', 'ASSISTANT']
      add_scene_token: False
      add_img_token: True
      use_lora: True
      train_emb: True
      train_img_proj: True
      no_obj: False
      max_obj_num: 100
      bidirection: False
      add_pos_emb: False
      feat_fusion: False
      fuse_with_id: False
      use_objid: True
      use_location_token: False }
  lora: {
      lora_target_modules: ['q_proj', 'v_proj', 'k_proj', 'o_proj', 'gate_proj', 'up_proj', 'down_proj']
      lora_r: 16
      lora_alpha: 16
      lora_dropout: 0.05 }
  optimizer: {
      opt: adamW
      lr: 5e-06
      opt_betas: [0.9, 0.999]
      weight_decay: 0.02
      scaler_enable: False
      max_grad_norm: 0.01
      different_lr: {
          enable: False
          module_names: ['model.embed_tokens']
          lr: [0.0005]
          wd: [0.02] } }
  scheduler: {
      sched: cosine
      epochs: 3
      min_lr_multi: 0.01
      warmup_epochs: 0.1 }
  evaluate: False
  wandb: {
      enable: False
      entity: huanghaifeng
      project: Scene-LLM }
  dist_url: env://
  device: cuda
  output_dir: outputs/manual_run_lr5e-6_ep3_scanrefer__debug
  resume: False
  debug: False
  log_freq: 20
  seed: 42
  save_latest: False
  do_save: True
  auto_resume: True
  pretrained_path: 
  img_projector_path: 
  gpu_num: 1
  distributed: False }
